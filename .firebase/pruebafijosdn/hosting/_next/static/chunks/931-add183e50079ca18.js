"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{285:(e,t,a)=>{a.d(t,{$:()=>c,r:()=>i});var s=a(5155),r=a(2115),o=a(4253),n=a(2085),d=a(9434);let i=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:a,variant:r,size:n,asChild:c=!1,...l}=e,u=c?o.DX:"button";return(0,s.jsx)(u,{className:(0,d.cn)(i({variant:r,size:n,className:a})),ref:t,...l})});c.displayName="Button"},5489:(e,t,a)=>{a.d(t,{$O:()=>h,FP:()=>y,Jb:()=>o,K6:()=>l,Le:()=>f,M9:()=>c,TK:()=>d,U$:()=>u,hG:()=>i,ju:()=>b,kU:()=>x,lo:()=>n,md:()=>v,oT:()=>_,sE:()=>p,sl:()=>m,t5:()=>w,ye:()=>g});var s=a(6104),r=a(5317);a(858);let o=async(e,t)=>{let a=(0,r.P)((0,r.rJ)(s.db,"users"),(0,r._M)("email","==",e.toLowerCase()));if(!(await (0,r.GG)(a)).empty)throw Error("El correo '".concat(e,"' ya ha sido invitado o registrado."));await (0,r.gS)((0,r.rJ)(s.db,"users"),{email:e.toLowerCase(),role:t,status:"invitado",name:"Usuario Pendiente"})},n=async e=>{let t=(0,r.rJ)(s.db,"users"),a=e?(0,r.P)(t,(0,r._M)("role","==",e)):t;return(await (0,r.GG)(a)).docs.map(e=>({id:e.id,...e.data()}))},d=async(e,t)=>{await (0,r.mZ)((0,r.H9)(s.db,"users",e),t)},i=async e=>{await (0,r.kd)((0,r.H9)(s.db,"users",e))},c=async e=>{await (0,r.c4)(s.db,async t=>{let a=(0,r.P)((0,r.rJ)(s.db,"assets"),(0,r._M)("name","==",e.name),(0,r._M)("status","==","en stock")),o=await (0,r.GG)(a);if(o.empty){let a=(0,r.H9)((0,r.rJ)(s.db,"assets"));t.set(a,{...e,status:"en stock"})}else{let a=o.docs[0],s=a.data().stock||0;t.update(a.ref,{stock:s+e.stock})}})},l=async()=>{let e=(0,r.rJ)(s.db,"assignmentRequests"),t=(0,r.P)(e,(0,r._M)("status","==","pendiente de env\xedo"));return(await (0,r.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))},u=async e=>{await (0,r.mZ)((0,r.H9)(s.db,"assignmentRequests",e),{status:"enviado"})},f=async()=>{let e=(0,r.P)((0,r.rJ)(s.db,"devolutionProcesses"),(0,r._M)("status","==","iniciado"));return(await (0,r.GG)(e)).docs.map(e=>({id:e.id,...e.data()}))},p=async(e,t)=>{await (0,r.c4)(s.db,async a=>{let o=(0,r.H9)(s.db,"devolutionProcesses",e),n=(0,r.H9)(s.db,"assets",t),d=await a.get(o);if(!d.exists())throw Error("Proceso de devoluci\xf3n no encontrado.");let i=d.data().assets.map(e=>e.id===t?{...e,verified:!0}:e);a.update(o,{assets:i}),a.update(n,{status:"en stock",employeeId:" ",employeeName:" "})})},m=async e=>{let t=(0,r.H9)(s.db,"devolutionProcesses",e),a=await (0,r.x7)(t);if(!a.exists())throw Error("Proceso de devoluci\xf3n no encontrado.");if(a.data().assets.every(e=>e.verified))await (0,r.mZ)(t,{status:"completado"});else throw Error("No todos los activos han sido verificados.")},v=async()=>{let e=(0,r.rJ)(s.db,"assets"),t=(0,r.P)(e,(0,r._M)("status","==","en stock"),(0,r._M)("stock",">",0));return(await (0,r.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))},b=async e=>await (0,r.c4)(s.db,async t=>{let a=(0,r.H9)(s.db,"assets",e.assetId),o=await t.get(a);if(!o.exists())throw Error("Activo no encontrado.");let n=(o.data().stock||0)>=e.quantity?"pendiente de env\xedo":"pendiente por stock",d=(0,r.H9)((0,r.rJ)(s.db,"assignmentRequests"));return t.set(d,{...e,date:r.Dc.now(),status:n}),{status:n}}),y=async()=>{let e=(0,r.P)((0,r.rJ)(s.db,"replacementRequests"),(0,r._M)("status","==","pendiente"));return(await (0,r.GG)(e)).docs.map(e=>({id:e.id,...e.data()}))},w=async(e,t)=>{await (0,r.mZ)((0,r.H9)(s.db,"replacementRequests",e),{status:t})},g=async e=>{let t=(0,r.P)((0,r.rJ)(s.db,"assets"),(0,r._M)("employeeId","==",e));return(await (0,r.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))},h=async e=>{await (0,r.mZ)((0,r.H9)(s.db,"assets",e),{status:"activo"})},x=async(e,t)=>{await (0,r.mZ)((0,r.H9)(s.db,"assets",e),{status:"en disputa",rejectionReason:t})},_=async(e,t)=>{let a=(0,r.P)((0,r.rJ)(s.db,"assets"),(0,r._M)("employeeId","==",e),(0,r._M)("status","==","activo")),o=await (0,r.GG)(a);if(o.empty)throw Error("No tienes activos con estado 'activo' para devolver.");let n=(0,r.wP)(s.db),d=[];for(let e of o.docs){n.update(e.ref,{status:"en devoluci\xf3n"});let t=e.data();d.push({id:e.id,name:t.name,serial:t.serial||"N/A",verified:!1})}let i=(0,r.H9)((0,r.rJ)(s.db,"devolutionProcesses"));n.set(i,{employeeId:e,employeeName:t,assets:d,status:"iniciado",date:r.Dc.now()}),await n.commit()}},6104:(e,t,a)=>{a.d(t,{db:()=>i,j2:()=>c});var s=a(3915),r=a(5317),o=a(858),n=a(3004);let d=(0,s.Dk)().length?(0,s.Sx)():(0,s.Wp)({apiKey:"AIzaSyB1ZM8tppg9wvPbVb-S_Tst3VdrzVmJR_4",authDomain:"pruebasfijosdn1.firebaseapp.com",projectId:"pruebasfijosdn1",storageBucket:"pruebasfijosdn1.firebasestorage.app",messagingSenderId:"1085419668125",appId:"1:1085419668125:web:3c9e059953cdd953774a74"}),i=(0,r.aU)(d);(0,o.c7)(d);let c=(0,n.xI)(d)},6695:(e,t,a)=>{a.d(t,{BT:()=>c,Wu:()=>l,ZB:()=>i,Zp:()=>n,aR:()=>d,wL:()=>u});var s=a(5155),r=a(2115),o=a(9434);let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...r})});n.displayName="Card";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",a),...r})});d.displayName="CardHeader";let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",a),...r})});i.displayName="CardTitle";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",a),...r})});c.displayName="CardDescription";let l=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",a),...r})});l.displayName="CardContent";let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",a),...r})});u.displayName="CardFooter"},7481:(e,t,a)=>{a.d(t,{dj:()=>f});var s=a(2115);let r=0,o=new Map,n=e=>{if(o.has(e))return;let t=setTimeout(()=>{o.delete(e),l({type:"REMOVE_TOAST",toastId:e})},1e6);o.set(e,t)},d=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?n(a):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},i=[],c={toasts:[]};function l(e){c=d(c,e),i.forEach(e=>{e(c)})}function u(e){let{...t}=e,a=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>l({type:"DISMISS_TOAST",toastId:a});return l({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>l({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function f(){let[e,t]=s.useState(c);return s.useEffect(()=>(i.push(t),()=>{let e=i.indexOf(t);e>-1&&i.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>l({type:"DISMISS_TOAST",toastId:e})}}},9434:(e,t,a)=>{a.d(t,{cn:()=>o});var s=a(2596),r=a(9688);function o(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}},9465:(e,t,a)=>{a.d(t,{A:()=>c,AuthProvider:()=>l});var s=a(5155),r=a(2115),o=a(3004),n=a(5317),d=a(6104);let i=(0,r.createContext)();function c(){return(0,r.useContext)(i)}function l(e){let{children:t}=e,[a,c]=(0,r.useState)(null),[l,u]=(0,r.useState)(null),[f,p]=(0,r.useState)(null),[m,v]=(0,r.useState)(!0),b=async e=>{if(!e){p(null),u(null);return}try{let t=(0,n.P)((0,n.rJ)(d.db,"users"),(0,n._M)("email","==",e.email.toLowerCase())),a=await (0,n.GG)(t);if(a.empty)p(null),u(null);else{let t=a.docs[0],s=t.data();if("invitado"===s.status){await (0,n.mZ)(t.ref,{status:"active",uid:e.uid});let a=(await (0,n.x7)(t.ref)).data();p(a),u(a.role||null)}else p(s),u(s.role||null)}}catch(e){console.error("Error fetching user data:",e),p(null),u(null)}};return(0,r.useEffect)(()=>(0,o.hg)(d.j2,async e=>{c(e),await b(e),v(!1)}),[]),(0,s.jsx)(i.Provider,{value:{currentUser:a,userRole:l,userData:f,login:function(e,t){return(0,o.x9)(d.j2,e,t)},logout:function(){return(0,o.CI)(d.j2)},resetPassword:function(e){return(0,o.J1)(d.j2,e)}},children:!m&&t})}}}]);