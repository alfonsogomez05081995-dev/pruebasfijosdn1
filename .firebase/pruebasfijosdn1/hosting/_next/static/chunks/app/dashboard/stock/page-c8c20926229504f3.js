(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[600],{668:(e,s,r)=>{Promise.resolve().then(r.bind(r,3142))},968:(e,s,r)=>{"use strict";r.d(s,{b:()=>l});var i=r(2115),a=r(3540),n=r(5155),t=i.forwardRef((e,s)=>(0,n.jsx)(a.sG.label,{...e,ref:s,onMouseDown:s=>{var r;s.target.closest("button, input, select, textarea")||(null==(r=e.onMouseDown)||r.call(e,s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));t.displayName="Label";var l=t},2383:()=>{},2523:(e,s,r)=>{"use strict";r.d(s,{p:()=>t});var i=r(5155),a=r(2115),n=r(9434);let t=a.forwardRef((e,s)=>{let{className:r,type:a,...t}=e;return(0,i.jsx)("input",{type:a,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:s,...t})});t.displayName="Input"},3142:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>k});var i=r(5155),a=r(2115),n=r(5695),t=r(9465),l=r(5489),c=r(7481),o=r(6695),d=r(5127),h=r(285),u=r(6126),x=r(157);let p=(0,x.A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),j=(0,x.A)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);var m=r(7223),v=r(4165),f=r(2523),g=r(5057),b=r(3925);let y=e=>e?e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()):"N/A";function k(){let{userData:e,loading:s}=(0,t.A)(),r=(0,n.useRouter)(),{toast:x}=(0,c.dj)(),[k,N]=(0,a.useState)([]),[A,C]=(0,a.useState)(!1),[w,E]=(0,a.useState)(!1),[S,_]=(0,a.useState)(null),[R,D]=(0,a.useState)({});(0,a.useEffect)(()=>{s||e&&["master","logistica"].includes(e.role)||r.push("/dashboard")},[e,s,r]);let F=(0,a.useCallback)(async()=>{try{let e=await (0,l.ZK)();N(e)}catch(e){console.error("Error fetching inventory:",e),x({variant:"destructive",title:"Error",description:"No se pudo cargar el inventario."})}},[x]);(0,a.useEffect)(()=>{e&&F()},[e,F]);let M=e=>{_(e),D({name:e.name,reference:e.reference,serial:e.serial,location:e.location,stock:e.stock,tipo:e.tipo,status:e.status}),C(!0)},z=async e=>{if(e.preventDefault(),S)try{let e={...R};"string"==typeof e.stock&&(e.stock=parseInt(e.stock,10)||0),await (0,l.gT)(S.id,e),x({title:"\xc9xito",description:"Activo actualizado correctamente."}),C(!1),F()}catch(e){console.error("Error updating asset:",e),x({variant:"destructive",title:"Error",description:e.message||"No se pudo actualizar el activo."})}},$=e=>{_(e),E(!0)},G=async()=>{if(S)try{await (0,l.AO)(S.id),x({title:"\xc9xito",description:"Activo eliminado correctamente."}),E(!1),F()}catch(e){console.error("Error deleting asset:",e),x({variant:"destructive",title:"Error",description:e.message||"No se pudo eliminar el activo."})}},H=e=>{let{id:s,value:r}=e.target;D(e=>({...e,[s]:r}))};return s||!e?(0,i.jsx)("div",{children:"Cargando..."}):["master","logistica"].includes(e.role)?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(o.Zp,{children:[(0,i.jsxs)(o.aR,{className:"flex flex-row items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(o.ZB,{children:"Inventario General"}),(0,i.jsx)(o.BT,{children:"Una vista completa de todos los activos en el sistema."})]}),(0,i.jsxs)(h.$,{onClick:()=>{let e=k.map(e=>({Referencia:e.reference||"N/A",Descripción:e.name,Serial:e.serial||"N/A","Tipo de Activo":y(e.tipo),Estado:e.status,Stock:e.stock||0,Ubicación:e.location||"N/A","Asignado a":e.employeeName||"N/A"})),s=b.Wp.json_to_sheet(e),r=b.Wp.book_new();b.Wp.book_append_sheet(r,s,"Inventario"),b._h(r,"InventarioGeneral.xlsx")},disabled:0===k.length,children:[(0,i.jsx)(p,{className:"h-4 w-4 mr-2"}),"Descargar Excel"]})]}),(0,i.jsx)(o.Wu,{children:(0,i.jsxs)(d.XI,{children:[(0,i.jsx)(d.A0,{children:(0,i.jsxs)(d.Hj,{children:[(0,i.jsx)(d.nd,{children:"Referencia"}),(0,i.jsx)(d.nd,{children:"Descripci\xf3n"}),(0,i.jsx)(d.nd,{children:"Tipo"}),(0,i.jsx)(d.nd,{children:"Serial"}),(0,i.jsx)(d.nd,{children:"Estado"}),(0,i.jsx)(d.nd,{children:"Stock"}),(0,i.jsx)(d.nd,{children:"Ubicaci\xf3n"}),(0,i.jsx)(d.nd,{children:"Asignado a"}),"master"===e.role&&(0,i.jsx)(d.nd,{className:"text-right",children:"Acciones"})]})}),(0,i.jsx)(d.BF,{children:k.length>0?k.map(s=>(0,i.jsxs)(d.Hj,{children:[(0,i.jsx)(d.nA,{children:s.reference||"N/A"}),(0,i.jsx)(d.nA,{className:"font-medium",children:s.name}),(0,i.jsx)(d.nA,{children:y(s.tipo)}),(0,i.jsx)(d.nA,{children:s.serial||"N/A"}),(0,i.jsx)(d.nA,{children:(0,i.jsx)(u.E,{variant:"outline",children:s.status})}),(0,i.jsx)(d.nA,{children:s.stock||0}),(0,i.jsx)(d.nA,{children:s.location||"N/A"}),(0,i.jsx)(d.nA,{children:s.employeeName||"N/A"}),"master"===e.role&&(0,i.jsxs)(d.nA,{className:"text-right",children:[(0,i.jsx)(h.$,{variant:"ghost",size:"icon",onClick:()=>M(s),children:(0,i.jsx)(j,{className:"h-4 w-4"})}),(0,i.jsx)(h.$,{variant:"ghost",size:"icon",onClick:()=>$(s),children:(0,i.jsx)(m.A,{className:"h-4 w-4 text-destructive"})})]})]},s.id)):(0,i.jsx)(d.Hj,{children:(0,i.jsx)(d.nA,{colSpan:"master"===e.role?9:8,className:"text-center",children:"No hay activos en el inventario."})})})]})})]}),(0,i.jsx)(v.lG,{open:A,onOpenChange:C,children:(0,i.jsxs)(v.Cf,{children:[(0,i.jsxs)(v.c7,{children:[(0,i.jsx)(v.L3,{children:"Editar Activo"}),(0,i.jsx)(v.rr,{children:"Modifique los detalles del activo. Haga clic en guardar para aplicar los cambios."})]}),(0,i.jsxs)("form",{onSubmit:z,className:"grid gap-4 py-4",children:[(0,i.jsxs)("div",{className:"grid gap-2",children:[(0,i.jsx)(g.J,{htmlFor:"reference",children:"Referencia"}),(0,i.jsx)(f.p,{id:"reference",value:R.reference||"",onChange:H})]}),(0,i.jsxs)("div",{className:"grid gap-2",children:[(0,i.jsx)(g.J,{htmlFor:"name",children:"Descripci\xf3n"}),(0,i.jsx)(f.p,{id:"name",value:R.name||"",onChange:H})]}),(0,i.jsxs)("div",{className:"grid gap-2",children:[(0,i.jsx)(g.J,{htmlFor:"serial",children:"Serial"}),(0,i.jsx)(f.p,{id:"serial",value:R.serial||"",onChange:H})]}),(0,i.jsxs)("div",{className:"grid gap-2",children:[(0,i.jsx)(g.J,{htmlFor:"location",children:"Ubicaci\xf3n"}),(0,i.jsx)(f.p,{id:"location",value:R.location||"",onChange:H})]}),(0,i.jsxs)("div",{className:"grid gap-2",children:[(0,i.jsx)(g.J,{htmlFor:"stock",children:"Stock"}),(0,i.jsx)(f.p,{id:"stock",type:"number",value:R.stock||0,onChange:H})]}),(0,i.jsxs)(v.Es,{children:[(0,i.jsx)(h.$,{type:"button",variant:"outline",onClick:()=>C(!1),children:"Cancelar"}),(0,i.jsx)(h.$,{type:"submit",children:"Guardar Cambios"})]})]})]})}),(0,i.jsx)(v.lG,{open:w,onOpenChange:E,children:(0,i.jsxs)(v.Cf,{children:[(0,i.jsxs)(v.c7,{children:[(0,i.jsx)(v.L3,{children:"\xbfEst\xe1 seguro?"}),(0,i.jsxs)(v.rr,{children:['Esta acci\xf3n no se puede deshacer. El activo "',null==S?void 0:S.name,'" ser\xe1 eliminado permanentemente de la base de datos.']})]}),(0,i.jsxs)(v.Es,{children:[(0,i.jsx)(h.$,{variant:"outline",onClick:()=>E(!1),children:"Cancelar"}),(0,i.jsx)(h.$,{variant:"destructive",onClick:G,children:"Eliminar"})]})]})})]}):(0,i.jsx)("div",{children:"Acceso no autorizado."})}},3686:()=>{},5057:(e,s,r)=>{"use strict";r.d(s,{J:()=>o});var i=r(5155),a=r(2115),n=r(968),t=r(2085),l=r(9434);let c=(0,t.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,i.jsx)(n.b,{ref:s,className:(0,l.cn)(c(),r),...a})});o.displayName=n.b.displayName},5695:(e,s,r)=>{"use strict";var i=r(8999);r.o(i,"useRouter")&&r.d(s,{useRouter:function(){return i.useRouter}})},7223:(e,s,r)=>{"use strict";r.d(s,{A:()=>i});let i=(0,r(157).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[992,416,524,686,908,977,48,441,684,358],()=>s(668)),_N_E=e.O()}]);