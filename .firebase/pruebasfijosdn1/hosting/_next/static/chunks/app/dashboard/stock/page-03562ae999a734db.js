(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[600],{968:(e,s,i)=>{"use strict";i.d(s,{b:()=>l});var r=i(2115),a=i(3540),t=i(5155),n=r.forwardRef((e,s)=>(0,t.jsx)(a.sG.label,{...e,ref:s,onMouseDown:s=>{var i;s.target.closest("button, input, select, textarea")||(null==(i=e.onMouseDown)||i.call(e,s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));n.displayName="Label";var l=n},1586:(e,s,i)=>{Promise.resolve().then(i.bind(i,3142))},2383:()=>{},2523:(e,s,i)=>{"use strict";i.d(s,{p:()=>n});var r=i(5155),a=i(2115),t=i(9434);let n=a.forwardRef((e,s)=>{let{className:i,type:a,...n}=e;return(0,r.jsx)("input",{type:a,className:(0,t.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",i),ref:s,...n})});n.displayName="Input"},3142:(e,s,i)=>{"use strict";i.r(s),i.d(s,{default:()=>k});var r=i(5155),a=i(2115),t=i(5695),n=i(9465),l=i(5489),c=i(7481),o=i(6695),d=i(5127),h=i(285),u=i(6126),x=i(157);let p=(0,x.A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),j=(0,x.A)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);var m=i(7223),v=i(4165),g=i(2523),f=i(5057),b=i(3925);let y=e=>e?e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()):"N/A";function k(){let{userData:e,loading:s}=(0,n.A)(),i=(0,t.useRouter)(),{toast:x}=(0,c.dj)(),[k,N]=(0,a.useState)([]),[A,w]=(0,a.useState)(!1),[C,E]=(0,a.useState)(!1),[S,_]=(0,a.useState)(null),[D,R]=(0,a.useState)({});(0,a.useEffect)(()=>{s||e&&["master","logistica"].includes(e.role)||i.push("/dashboard")},[e,s,i]);let M=(0,a.useCallback)(async()=>{try{let e=await (0,l.ZK)();N(e)}catch(e){console.error("Error fetching inventory:",e),x({variant:"destructive",title:"Error",description:"No se pudo cargar el inventario."})}},[x]);(0,a.useEffect)(()=>{e&&M()},[e,M]);let z=e=>{_(e),R({name:e.name,reference:e.reference,serial:e.serial,location:e.location,stock:e.stock,tipo:e.tipo,status:e.status}),w(!0)},F=async e=>{if(e.preventDefault(),S)try{let e={...D};"string"==typeof e.stock&&(e.stock=parseInt(e.stock,10)||0),await (0,l.gT)(S.id,e),x({title:"\xc9xito",description:"Activo actualizado correctamente."}),w(!1),M()}catch(e){console.error("Error updating asset:",e),x({variant:"destructive",title:"Error",description:e.message||"No se pudo actualizar el activo."})}},$=e=>{_(e),E(!0)},G=async()=>{if(S)try{await (0,l.AO)(S.id),x({title:"\xc9xito",description:"Activo eliminado correctamente."}),E(!1),M()}catch(e){console.error("Error deleting asset:",e),x({variant:"destructive",title:"Error",description:e.message||"No se pudo eliminar el activo."})}},H=e=>{let{id:s,value:i}=e.target;R(e=>({...e,[s]:i}))};return s||!e?(0,r.jsx)("div",{children:"Cargando..."}):["master","logistica"].includes(e.role)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(o.Zp,{children:[(0,r.jsxs)(o.aR,{className:"flex flex-row items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(o.ZB,{children:"Inventario General"}),(0,r.jsx)(o.BT,{children:"Una vista completa de todos los activos en el sistema."})]}),(0,r.jsxs)(h.$,{onClick:()=>{let e=k.map(e=>({Referencia:e.reference||"N/A",Descripción:e.name,Serial:e.serial||"N/A","Tipo de Activo":y(e.tipo),Estado:e.status,Stock:e.stock||0,Ubicación:e.location||"N/A","Asignado a":e.employeeName||"N/A"})),s=b.Wp.json_to_sheet(e),i=b.Wp.book_new();b.Wp.book_append_sheet(i,s,"Inventario"),b._h(i,"InventarioGeneral.xlsx")},disabled:0===k.length,children:[(0,r.jsx)(p,{className:"h-4 w-4 mr-2"}),"Descargar Excel"]})]}),(0,r.jsx)(o.Wu,{children:(0,r.jsxs)(d.XI,{children:[(0,r.jsx)(d.A0,{children:(0,r.jsxs)(d.Hj,{children:[(0,r.jsx)(d.nd,{children:"Descripci\xf3n"}),(0,r.jsx)(d.nd,{children:"Tipo"}),(0,r.jsx)(d.nd,{children:"Serial"}),(0,r.jsx)(d.nd,{children:"Estado"}),(0,r.jsx)(d.nd,{children:"Stock"}),(0,r.jsx)(d.nd,{children:"Ubicaci\xf3n"}),(0,r.jsx)(d.nd,{children:"Asignado a"}),"master"===e.role&&(0,r.jsx)(d.nd,{className:"text-right",children:"Acciones"})]})}),(0,r.jsx)(d.BF,{children:k.length>0?k.map(s=>(0,r.jsxs)(d.Hj,{children:[(0,r.jsx)(d.nA,{className:"font-medium",children:s.name}),(0,r.jsx)(d.nA,{children:y(s.tipo)}),(0,r.jsx)(d.nA,{children:s.serial||"N/A"}),(0,r.jsx)(d.nA,{children:(0,r.jsx)(u.E,{variant:"outline",children:s.status})}),(0,r.jsx)(d.nA,{children:s.stock||0}),(0,r.jsx)(d.nA,{children:s.location||"N/A"}),(0,r.jsx)(d.nA,{children:s.employeeName||"N/A"}),"master"===e.role&&(0,r.jsxs)(d.nA,{className:"text-right",children:[(0,r.jsx)(h.$,{variant:"ghost",size:"icon",onClick:()=>z(s),children:(0,r.jsx)(j,{className:"h-4 w-4"})}),(0,r.jsx)(h.$,{variant:"ghost",size:"icon",onClick:()=>$(s),children:(0,r.jsx)(m.A,{className:"h-4 w-4 text-destructive"})})]})]},s.id)):(0,r.jsx)(d.Hj,{children:(0,r.jsx)(d.nA,{colSpan:"master"===e.role?8:7,className:"text-center",children:"No hay activos en el inventario."})})})]})})]}),(0,r.jsx)(v.lG,{open:A,onOpenChange:w,children:(0,r.jsxs)(v.Cf,{children:[(0,r.jsxs)(v.c7,{children:[(0,r.jsx)(v.L3,{children:"Editar Activo"}),(0,r.jsx)(v.rr,{children:"Modifique los detalles del activo. Haga clic en guardar para aplicar los cambios."})]}),(0,r.jsxs)("form",{onSubmit:F,className:"grid gap-4 py-4",children:[(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(f.J,{htmlFor:"name",children:"Descripci\xf3n"}),(0,r.jsx)(g.p,{id:"name",value:D.name||"",onChange:H})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(f.J,{htmlFor:"serial",children:"Serial"}),(0,r.jsx)(g.p,{id:"serial",value:D.serial||"",onChange:H})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(f.J,{htmlFor:"location",children:"Ubicaci\xf3n"}),(0,r.jsx)(g.p,{id:"location",value:D.location||"",onChange:H})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(f.J,{htmlFor:"stock",children:"Stock"}),(0,r.jsx)(g.p,{id:"stock",type:"number",value:D.stock||0,onChange:H})]}),(0,r.jsxs)(v.Es,{children:[(0,r.jsx)(h.$,{type:"button",variant:"outline",onClick:()=>w(!1),children:"Cancelar"}),(0,r.jsx)(h.$,{type:"submit",children:"Guardar Cambios"})]})]})]})}),(0,r.jsx)(v.lG,{open:C,onOpenChange:E,children:(0,r.jsxs)(v.Cf,{children:[(0,r.jsxs)(v.c7,{children:[(0,r.jsx)(v.L3,{children:"\xbfEst\xe1 seguro?"}),(0,r.jsxs)(v.rr,{children:['Esta acci\xf3n no se puede deshacer. El activo "',null==S?void 0:S.name,'" ser\xe1 eliminado permanentemente de la base de datos.']})]}),(0,r.jsxs)(v.Es,{children:[(0,r.jsx)(h.$,{variant:"outline",onClick:()=>E(!1),children:"Cancelar"}),(0,r.jsx)(h.$,{variant:"destructive",onClick:G,children:"Eliminar"})]})]})})]}):(0,r.jsx)("div",{children:"Acceso no autorizado."})}},3686:()=>{},5057:(e,s,i)=>{"use strict";i.d(s,{J:()=>o});var r=i(5155),a=i(2115),t=i(968),n=i(2085),l=i(9434);let c=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=a.forwardRef((e,s)=>{let{className:i,...a}=e;return(0,r.jsx)(t.b,{ref:s,className:(0,l.cn)(c(),i),...a})});o.displayName=t.b.displayName},5695:(e,s,i)=>{"use strict";var r=i(8999);i.o(r,"useRouter")&&i.d(s,{useRouter:function(){return r.useRouter}})},7223:(e,s,i)=>{"use strict";i.d(s,{A:()=>r});let r=(0,i(157).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[992,416,524,686,908,977,48,441,684,358],()=>s(1586)),_N_E=e.O()}]);