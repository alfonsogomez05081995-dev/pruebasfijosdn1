"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[48],{285:(e,t,a)=>{a.d(t,{$:()=>l,r:()=>i});var s=a(5155),r=a(2115),o=a(4253),d=a(2085),n=a(9434);let i=(0,d.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=r.forwardRef((e,t)=>{let{className:a,variant:r,size:d,asChild:l=!1,...c}=e,u=l?o.DX:"button";return(0,s.jsx)(u,{className:(0,n.cn)(i({variant:r,size:d,className:a})),ref:t,...c})});l.displayName="Button"},4165:(e,t,a)=>{a.d(t,{Cf:()=>f,Es:()=>p,L3:()=>b,c7:()=>m,lG:()=>i,rr:()=>y,zM:()=>l});var s=a(5155),r=a(2115),o=a(5821),d=a(5318),n=a(9434);let i=o.bL,l=o.l9,c=o.ZL;o.bm;let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(o.hJ,{ref:t,className:(0,n.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});u.displayName=o.hJ.displayName;let f=r.forwardRef((e,t)=>{let{className:a,children:r,...i}=e;return(0,s.jsxs)(c,{children:[(0,s.jsx)(u,{}),(0,s.jsxs)(o.UC,{ref:t,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...i,children:[r,(0,s.jsxs)(o.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(d.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=o.UC.displayName;let m=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};m.displayName="DialogHeader";let p=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};p.displayName="DialogFooter";let b=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(o.hE,{ref:t,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",a),...r})});b.displayName=o.hE.displayName;let y=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(o.VY,{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...r})});y.displayName=o.VY.displayName},5127:(e,t,a)=>{a.d(t,{A0:()=>n,BF:()=>i,Hj:()=>l,XI:()=>d,nA:()=>u,nd:()=>c});var s=a(5155),r=a(2115),o=a(9434);let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:t,className:(0,o.cn)("w-full caption-bottom text-sm",a),...r})})});d.displayName="Table";let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("thead",{ref:t,className:(0,o.cn)("[&_tr]:border-b",a),...r})});n.displayName="TableHeader";let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("tbody",{ref:t,className:(0,o.cn)("[&_tr:last-child]:border-0",a),...r})});i.displayName="TableBody",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("tfoot",{ref:t,className:(0,o.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...r})}).displayName="TableFooter";let l=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("tr",{ref:t,className:(0,o.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...r})});l.displayName="TableRow";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("th",{ref:t,className:(0,o.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...r})});c.displayName="TableHead";let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("td",{ref:t,className:(0,o.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...r})});u.displayName="TableCell",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("caption",{ref:t,className:(0,o.cn)("mt-4 text-sm text-muted-foreground",a),...r})}).displayName="TableCaption"},5489:(e,t,a)=>{a.d(t,{$O:()=>_,AO:()=>m,BW:()=>b,FP:()=>N,Jb:()=>o,K6:()=>p,Le:()=>g,M9:()=>c,MZ:()=>h,TK:()=>n,U$:()=>y,ZK:()=>u,gT:()=>f,hG:()=>i,kU:()=>S,lo:()=>d,md:()=>x,oT:()=>T,s2:()=>l,sE:()=>v,sl:()=>w,t5:()=>j,ye:()=>E});var s=a(6104),r=a(5317);a(858);let o=async(e,t)=>{let a=(0,r.P)((0,r.rJ)(s.db,"users"),(0,r._M)("email","==",e.toLowerCase()));if(!(await (0,r.GG)(a)).empty)throw Error("El correo '".concat(e,"' ya ha sido invitado o registrado."));await (0,r.gS)((0,r.rJ)(s.db,"users"),{email:e.toLowerCase(),role:t,status:"invitado",name:"Usuario Pendiente"})},d=async e=>{let t=(0,r.rJ)(s.db,"users"),a=e?(0,r.P)(t,(0,r._M)("role","==",e)):t;return(await (0,r.GG)(a)).docs.map(e=>({id:e.id,...e.data()}))},n=async(e,t)=>{await (0,r.mZ)((0,r.H9)(s.db,"users",e),t)},i=async e=>{await (0,r.kd)((0,r.H9)(s.db,"users",e))},l=async e=>{let t=(0,r.wP)(s.db);e.forEach(e=>{let a=(0,r.H9)((0,r.rJ)(s.db,"assets"));t.set(a,{...e,status:"en stock"})}),await t.commit()},c=async e=>{await (0,r.c4)(s.db,async t=>{let a=(0,r.P)((0,r.rJ)(s.db,"assets"),(0,r._M)("name","==",e.name),(0,r._M)("status","==","en stock")),o=await (0,r.GG)(a);if(o.empty){let a=(0,r.H9)((0,r.rJ)(s.db,"assets"));t.set(a,{...e,status:"en stock"})}else{let a=o.docs[0],s=a.data().stock||0;t.update(a.ref,{stock:s+e.stock})}})},u=async()=>{let e=(0,r.rJ)(s.db,"assets");return(await (0,r.GG)(e)).docs.map(e=>({id:e.id,...e.data()}))},f=async(e,t)=>{let a=(0,r.H9)(s.db,"assets",e);await (0,r.mZ)(a,t)},m=async e=>{let t=(0,r.H9)(s.db,"assets",e);await (0,r.kd)(t)},p=async()=>{let e=(0,r.rJ)(s.db,"assignmentRequests"),t=(0,r.P)(e,(0,r._M)("status","==","pendiente de env\xedo"));return(await (0,r.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))},b=async()=>{let e=(0,r.rJ)(s.db,"assignmentRequests");return(await (0,r.GG)(e)).docs.map(e=>({id:e.id,...e.data()}))},y=async(e,t,a,o)=>{await (0,r.c4)(s.db,async d=>{var n,i;let l=(0,r.H9)(s.db,"assignmentRequests",e),c=await d.get(l);if(!c.exists())throw Error("Solicitud no encontrada.");let u=c.data(),f=(0,r.H9)(s.db,"users",u.employeeId),m=await d.get(f);if(!m.exists()||!(null==(n=m.data())?void 0:n.uid))throw Error("El documento del empleado asignado no es v\xe1lido o no tiene un UID de autenticaci\xf3n.");let p=null==(i=m.data())?void 0:i.uid,b=(0,r.H9)(s.db,"assets",u.assetId),y=await d.get(b);if(!y.exists())throw Error("Activo en stock no encontrado.");let g=y.data(),v=["equipo_computo","herramienta_electrica"].includes(g.tipo);if(v&&!o)throw Error("Se requiere un n\xfamero de serial para este tipo de activo.");if(v&&1!==u.quantity)throw Error("No se puede asignar m\xe1s de una unidad de un activo con serial en una sola solicitud.");let w=g.stock||0;if(w<u.quantity)throw Error("Stock insuficiente. Stock actual: ".concat(w,", Solicitado: ").concat(u.quantity,"."));let x=(0,r.H9)((0,r.rJ)(s.db,"assets"));d.set(x,{name:g.name,reference:g.reference||"",tipo:g.tipo,serial:o||null,status:"recibido pendiente",employeeId:u.employeeId,employeeUid:p,employeeName:u.employeeName,assignedDate:r.Dc.now(),stock:u.quantity}),d.update(b,{stock:w-u.quantity}),d.update(l,{status:"enviado",trackingNumber:t,carrier:a})})},g=async()=>{let e=(0,r.P)((0,r.rJ)(s.db,"devolutionProcesses"),(0,r._M)("status","==","iniciado"));return(await (0,r.GG)(e)).docs.map(e=>({id:e.id,...e.data()}))},v=async(e,t)=>{await (0,r.c4)(s.db,async a=>{let o=(0,r.H9)(s.db,"devolutionProcesses",e),d=(0,r.H9)(s.db,"assets",t),n=await a.get(o);if(!n.exists())throw Error("Proceso de devoluci\xf3n no encontrado.");let i=n.data().assets.map(e=>e.id===t?{...e,verified:!0}:e);a.update(o,{assets:i}),a.update(d,{status:"en stock",employeeId:" ",employeeName:" "})})},w=async e=>{let t=(0,r.H9)(s.db,"devolutionProcesses",e),a=await (0,r.x7)(t);if(!a.exists())throw Error("Proceso de devoluci\xf3n no encontrado.");if(a.data().assets.every(e=>e.verified))await (0,r.mZ)(t,{status:"completado"});else throw Error("No todos los activos han sido verificados.")},x=async()=>{let e=(0,r.rJ)(s.db,"assets"),t=(0,r.P)(e,(0,r._M)("status","==","en stock"),(0,r._M)("stock",">",0));return(await (0,r.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))},h=async e=>{let t=(0,r.wP)(s.db),a=(0,r.rJ)(s.db,"assignmentRequests");for(let s of e){let e=(0,r.H9)(a);t.set(e,{...s,date:r.Dc.now(),status:"pendiente de env\xedo"})}await t.commit()},N=async()=>{let e=(0,r.P)((0,r.rJ)(s.db,"replacementRequests"),(0,r._M)("status","==","pendiente"));return(await (0,r.GG)(e)).docs.map(e=>({id:e.id,...e.data()}))},j=async(e,t)=>{await (0,r.mZ)((0,r.H9)(s.db,"replacementRequests",e),{status:t})},E=async e=>{let t=(0,r.P)((0,r.rJ)(s.db,"assets"),(0,r._M)("employeeId","==",e));return(await (0,r.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))},_=async e=>{await (0,r.mZ)((0,r.H9)(s.db,"assets",e),{status:"activo"})},S=async(e,t)=>{await (0,r.mZ)((0,r.H9)(s.db,"assets",e),{status:"en disputa",rejectionReason:t})},T=async(e,t)=>{let a=(0,r.P)((0,r.rJ)(s.db,"assets"),(0,r._M)("employeeId","==",e),(0,r._M)("status","==","activo")),o=await (0,r.GG)(a);if(o.empty)throw Error("No tienes activos con estado 'activo' para devolver.");let d=(0,r.wP)(s.db),n=[];for(let e of o.docs){d.update(e.ref,{status:"en devoluci\xf3n"});let t=e.data();n.push({id:e.id,name:t.name,serial:t.serial||"N/A",verified:!1})}let i=(0,r.H9)((0,r.rJ)(s.db,"devolutionProcesses"));d.set(i,{employeeId:e,employeeName:t,assets:n,status:"iniciado",date:r.Dc.now()}),await d.commit()}},6104:(e,t,a)=>{a.d(t,{db:()=>i,j2:()=>l});var s=a(3915),r=a(5317),o=a(858),d=a(3004);let n=(0,s.Dk)().length?(0,s.Sx)():(0,s.Wp)({apiKey:"AIzaSyB1ZM8tppg9wvPbVb-S_Tst3VdrzVmJR_4",authDomain:"pruebasfijosdn1.firebaseapp.com",projectId:"pruebasfijosdn1",storageBucket:"pruebasfijosdn1.firebasestorage.app",messagingSenderId:"1085419668125",appId:"1:1085419668125:web:3c9e059953cdd953774a74",measurementId:"G-S6EN39B1EX"}),i=(0,r.aU)(n);(0,o.c7)(n);let l=(0,d.xI)(n)},6126:(e,t,a)=>{a.d(t,{E:()=>n});var s=a(5155);a(2115);var r=a(2085),o=a(9434);let d=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:t,variant:a,...r}=e;return(0,s.jsx)("div",{className:(0,o.cn)(d({variant:a}),t),...r})}},6695:(e,t,a)=>{a.d(t,{BT:()=>l,Wu:()=>c,ZB:()=>i,Zp:()=>d,aR:()=>n,wL:()=>u});var s=a(5155),r=a(2115),o=a(9434);let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...r})});d.displayName="Card";let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",a),...r})});n.displayName="CardHeader";let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",a),...r})});i.displayName="CardTitle";let l=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",a),...r})});l.displayName="CardDescription";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",a),...r})});c.displayName="CardContent";let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",a),...r})});u.displayName="CardFooter"},7481:(e,t,a)=>{a.d(t,{dj:()=>f});var s=a(2115);let r=0,o=new Map,d=e=>{if(o.has(e))return;let t=setTimeout(()=>{o.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);o.set(e,t)},n=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?d(a):e.toasts.forEach(e=>{d(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},i=[],l={toasts:[]};function c(e){l=n(l,e),i.forEach(e=>{e(l)})}function u(e){let{...t}=e,a=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:a});return c({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function f(){let[e,t]=s.useState(l);return s.useEffect(()=>(i.push(t),()=>{let e=i.indexOf(t);e>-1&&i.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},9434:(e,t,a)=>{a.d(t,{cn:()=>o});var s=a(2596),r=a(9688);function o(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}},9465:(e,t,a)=>{a.d(t,{A:()=>l,AuthProvider:()=>c});var s=a(5155),r=a(2115),o=a(3004),d=a(5317),n=a(6104);let i=(0,r.createContext)();function l(){return(0,r.useContext)(i)}function c(e){let{children:t}=e,[a,l]=(0,r.useState)(null),[c,u]=(0,r.useState)(null),[f,m]=(0,r.useState)(null),[p,b]=(0,r.useState)(!0),y=async e=>{if(!e){m(null),u(null);return}try{let t=(0,d.P)((0,d.rJ)(n.db,"users"),(0,d._M)("email","==",e.email.toLowerCase())),a=await (0,d.GG)(t);if(a.empty)m(null),u(null);else{let t=a.docs[0],s=t.data();if("invitado"===s.status){await (0,d.mZ)(t.ref,{status:"active",uid:e.uid});let a=await (0,d.x7)(t.ref),s=a.data();m({id:a.id,...s}),u(s.role||null)}else m({id:t.id,...s}),u(s.role||null)}}catch(e){console.error("Error fetching user data:",e),m(null),u(null)}};return(0,r.useEffect)(()=>(0,o.hg)(n.j2,async e=>{l(e),await y(e),b(!1)}),[]),(0,s.jsx)(i.Provider,{value:{currentUser:a,userRole:c,userData:f,login:function(e,t){return(0,o.x9)(n.j2,e,t)},logout:function(){return(0,o.CI)(n.j2)},resetPassword:function(e){return(0,o.J1)(n.j2,e)}},children:!p&&t})}}}]);